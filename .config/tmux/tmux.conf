# ──────────────────────────────────────────────
# Essentials
# ──────────────────────────────────────────────

# Eliminate escape key delay (default 500ms feels sluggish in vim)
set -s escape-time 0

# Increase scrollback buffer (default 2000 is too small for AI agent sessions)
set -g history-limit 50000

# Enable mouse support (scroll, click panes, resize panes)
set -g mouse on

# Start window and pane numbering at 1 (0 is far from other keys)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Enable focus events (needed by vim/neovim for autoread)
set -g focus-events on

# Resize to the largest client viewing THAT window, not the whole session
setw -g aggressive-resize on

# ──────────────────────────────────────────────
# Colors / True Color
# ──────────────────────────────────────────────

set -g default-terminal "tmux-256color"

# Enable true color (24-bit RGB) for terminals that support it
set -as terminal-features ",xterm-256color:RGB"

# ──────────────────────────────────────────────
# Clipboard / Copy-Paste
# ──────────────────────────────────────────────

# OSC 52 clipboard integration — works over SSH if your terminal supports it
# (Ghostty, iTerm2, Alacritty, WezTerm, Kitty, Termius, Blink Shell)
set -s set-clipboard on
set -g allow-passthrough on

# vi-style keys in copy mode
setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# ──────────────────────────────────────────────
# Key Bindings
# ──────────────────────────────────────────────

# Prefix: C-a (easier to reach than C-b, especially on phone keyboards)
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Reload config
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded"

# Intuitive splits, open in current directory
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Navigate panes with Alt+arrow (no prefix needed)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# New windows in current directory
bind c new-window -c "#{pane_current_path}"

# ──────────────────────────────────────────────
# Status Bar (minimal, phone-friendly)
# ──────────────────────────────────────────────

# Top position — away from on-screen keyboard on phones
set -g status-position top
set -g status-style "bg=default,fg=white"
set -g status-left "#[fg=green,bold] #S "
set -g status-left-length 20
set -g status-right ""
setw -g window-status-format " #I:#W "
setw -g window-status-current-format "#[fg=black,bg=green,bold] #I:#W "

# Longer display time for messages (helpful on small screens)
set -g display-time 3000
set -g display-panes-time 3000
